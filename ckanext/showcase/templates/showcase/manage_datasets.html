{% extends 'showcase/edit_base.html' %}

{% block subtitle %}{{ _('Showcases - Manage datasets') }}{% endblock %}

{% block wrapper_class %} ckanext-showcase-edit-wrapper{% endblock %}

{% block ckanext_showcase_edit_span %}span12{% endblock %}

{% block primary_content_inner %}
  <div class="clearfix">
    <h1 class="hide-heading">{{ _('Manage datasets') }}</h1>
    <h3 class="page-heading">
      {% block page_heading %}
          {{ _('Datasets in this showcase') }}
      {% endblock %}
    </h3>
    {% block form %}
      {% if c.showcase_pkgs %}
        <form method="POST" data-module="basic-form">
          <table class="table table-bordered table-header table-hover table-bulk-edit table-edit-hover" data-module="table-selectable-rows">
            <col width="8">
            <col width="120">
            <thead>
              <tr>
                <th></th>
                <th class="table-actions">
                  <div class="btn-group">
                    <button name="bulk_action.showcase_remove" value="remove" class="btn btn-danger" type="submit">
                      <i class="icon-remove"></i>
                      {{ _('Remove from Showcase') }}
                    </button>
                  </div>
                </th>
              </tr>
            </thead>
            <tbody>
              {% for package in c.showcase_pkgs %}
                {% set truncate = truncate or 180 %}
                {% set truncate_title = truncate_title or 80 %}
                {% set title = package.title or package.name %}
                {% set notes = h.markdown_extract(package.notes, extract_length=truncate) %}
                <tr>
                  <td>
                    <input type="checkbox" name="dataset_{{ package.id }}">
                  </td>
                  <td class="context">
                    <h3 class="dataset-heading">
                      {{ h.link_to(h.truncate(title, truncate_title), h.url_for(controller='package', action='read', id=package.name)) }}
                    </h3>
                    {% if notes %}
                      <p>{{ notes|urlize }}</p>
                    {% endif %}
                  </td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </form>
      {% else %}
        <p class="empty">
          {{ _('This showcase has no datasets associated to it') }}.
          {% if h.check_access('group_create') %}
            {% link_for _('How about adding some?'), controller='ckanext.showcase.controller:ShowcaseController', action='add_datasets', id=c.pkg_dict.name %}</a>
          {% endif %}
        </p>
      {% endif %}
    {% endblock %}
  </div>
{% endblock %}
